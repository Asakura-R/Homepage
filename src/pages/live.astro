---
import BaseLayout from '@layouts/BaseLayout.astro';
import NavigationCards from '@components/NavigationCards.astro';
import PageTitle from '@components/PageTitle.astro';
import SanpachiMic from '@components/SanpachiMic.astro';
import { getLives, formatDate, getDayOfWeek } from '@lib/microcms';

// microCMS„Åã„Çâ„Éá„Éº„ÇøÂèñÂæó
const { upcoming: upcomingLives, past: pastLives } = await getLives();

const formatDateShort = (date: string) => formatDate(date, 'short');
---

<BaseLayout title="„É©„Ç§„ÉñÊÉÖÂ†± | „Ç¢„Çµ„ÇØ„É©" currentPage="LIVE">
  <div class="pt-28 md:pt-32 pb-10 px-4 md:px-8">
    <div class="max-w-3xl mx-auto">
      <PageTitle en="LIVE" jp="„É©„Ç§„ÉñÊÉÖÂ†±" />
      
      <!-- Upcoming„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <section class="mb-10 md:mb-12">
        <div class="flex items-center gap-3 mb-5">
          <SanpachiMic size="sm" />
          <h2 class="text-xs font-bold tracking-widest text-pink">UPCOMING</h2>
        </div>
        
        {upcomingLives.length > 0 ? (
          <div class="flex flex-col gap-4">
            {upcomingLives.map(live => (
              <div class="p-5 md:p-7 bg-white/75 backdrop-blur-lg rounded-2xl border border-pink/15 shadow-glass transition-all hover:-translate-y-0.5 hover:shadow-glass-hover">
                <div class="flex flex-col md:flex-row md:items-center gap-4 md:gap-6">
                  
                  <!-- Êó•‰ªò -->
                  <div class="flex-shrink-0 md:text-center md:min-w-[80px]">
                    <div class="text-2xl md:text-3xl font-semibold text-pink">
                      {formatDateShort(live.date)}
                    </div>
                    <span class="inline-block mt-1 text-[11px] px-2.5 py-1 bg-pink/15 rounded-xl text-pink-dark font-semibold">
                      {getDayOfWeek(live.date)}
                    </span>
                  </div>
                  
                  <!-- ÊÉÖÂ†± -->
                  <div class="flex-1">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">{live.title}</h3>
                    <p class="text-sm text-gray-500 mb-1">üìç {live.venue}</p>
                    <p class="text-xs text-gray-400">
                      {live.openTime} OPEN / {live.startTime} START
                    </p>
                    {live.note && (
                      <p class="mt-3 text-xs text-purple bg-purple/5 rounded-lg px-3 py-2 inline-block">
                        {live.note}
                      </p>
                    )}
                  </div>
                  
                  <!-- „ÉÅ„Ç±„ÉÉ„Éà„Éú„Çø„É≥ -->
                  {live.ticketUrl && (
                    <a 
                      href={live.ticketUrl}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="btn btn-pink self-start md:self-center w-full md:w-auto text-center"
                    >
                      TICKET ‚Üí
                    </a>
                  )}
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div class="glass-card p-10 text-center">
            <p class="text-sm text-gray-400">ÁèæÂú®‰∫àÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„É©„Ç§„Éñ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
          </div>
        )}
      </section>
      
      <!-- Past„Çª„ÇØ„Ç∑„Éß„É≥ -->
      <section>
        <h2 class="text-xs font-bold tracking-widest text-gray-400 flex items-center gap-2 mb-5">
          <span class="w-5 h-px bg-gradient-to-r from-gray-400 to-transparent"></span>
          PAST
        </h2>
        
        {pastLives.length > 0 ? (
          <div class="flex flex-col gap-3">
            {pastLives.map(live => (
              <div class="p-5 md:p-6 bg-white/50 backdrop-blur-lg rounded-2xl border border-white/80 transition-all hover:-translate-y-0.5 hover:shadow-glass">
                <div class="flex flex-col md:flex-row md:items-center gap-3 md:gap-6">
                  
                  <!-- Êó•‰ªò -->
                  <div class="flex-shrink-0 md:text-center md:min-w-[80px]">
                    <div class="text-xl md:text-2xl font-semibold text-gray-500">
                      {formatDateShort(live.date)}
                    </div>
                    <span class="inline-block mt-1 text-[11px] px-2.5 py-1 bg-gray-100 rounded-xl text-gray-500 font-semibold">
                      {getDayOfWeek(live.date)}
                    </span>
                  </div>
                  
                  <!-- ÊÉÖÂ†± -->
                  <div class="flex-1">
                    <h3 class="text-base font-semibold text-gray-700 mb-1">{live.title}</h3>
                    <p class="text-sm text-gray-500">üìç {live.venue}</p>
                  </div>
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div class="glass-card p-10 text-center">
            <p class="text-sm text-gray-400">ÈÅéÂéª„ÅÆ„É©„Ç§„ÉñÊÉÖÂ†±„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
          </div>
        )}
        
        <!-- „ÇÇ„Å£„Å®Ë¶ã„Çã -->
        <div class="text-center mt-6">
          <button class="px-7 py-3 text-xs font-semibold tracking-wide text-purple border border-purple/30 rounded-3xl transition-all hover:bg-purple/5 hover:border-purple/50">
            VIEW MORE
          </button>
        </div>
      </section>
    </div>
  </div>
  
  <NavigationCards currentPage="LIVE" />
</BaseLayout>
